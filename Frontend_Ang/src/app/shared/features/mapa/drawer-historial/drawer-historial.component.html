<app-drawer-shell
  [(opened)]="opened"
  (openedChange)="onOpenedChange($event)"
  [title]="'Historial de bÃºsquedas'"
  position="right"
  [width]="'460px'"
>
  <div drawer-content>
    <ng-container *ngIf="(historial.historial$ | async) as lista">
      <p *ngIf="lista.length === 0" class="empty-msg">
        No hay bÃºsquedas recientes.
      </p>

      <div *ngFor="let h of lista" class="historial-item">
        <div class="info">
          <h4>{{ h.fecha }}</h4>
          <p>
            <strong>Zona:</strong> {{ h.ciudad || 'N/D' }} â€”
            <strong>{{
              h.operation === 'rent' ? 'Alquiler' : 'Venta'
            }}</strong>
          </p>

          <p class="filtros" *ngIf="h.filtros">
            <span *ngIf="h.filtros.min_price && h.filtros.max_price">
              ğŸ’¶ {{ h.filtros.min_price }}â€“{{ h.filtros.max_price }} â‚¬
            </span>
            <span *ngIf="h.filtros.min_size && h.filtros.max_size">
              ğŸ“ {{ h.filtros.min_size }}â€“{{ h.filtros.max_size }} mÂ²
            </span>
          </p>

          <div class="badge">{{ h.cantidad ?? 0 }} resultados</div>
        </div>

        <button class="remove-btn" (click)="eliminar(h.fecha)">
          <lucide-icon name="trash-2"></lucide-icon>
          Quitar
        </button>
      </div>
    </ng-container>
  </div>

  <div drawer-footer>
    <button class="clear-btn" (click)="borrarTodos()">
      <lucide-icon name="trash"></lucide-icon>
      Borrar historial
    </button>
  </div>
</app-drawer-shell>
